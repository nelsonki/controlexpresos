<div class="user-content-form">

    <mat-horizontal-stepper linear #stepper>
        <mat-step [stepControl]="firstFormGroup">
            <form [formGroup]="firstFormGroup">
                <ng-template matStepLabel> Cliente </ng-template>
                <div class="form-group"><br>
                    <mat-toolbar>
                        Datos del Cliente y Sucursal
                    </mat-toolbar><br>
                    <div class="row">

                        <div class="form-group" class="width-form-groud col-12 col-xs-6 col-sm-6 col-md-6 col-lg-6">
                            <mat-form-field class="example-full-width ">
                                <mat-label>Cliente(*)</mat-label>

                                <input type="text" placeholder="Cliente(*)" aria-label="Number" matInput formControlName="client">
                                <div class="typeahead--wrapper" *ngIf="openOptionClient">
                                    <ul class="typeahead--ul">
                                        <li *ngFor="let data of filteredOptions" (click)="
                               setDataFormul($event,
                                 data.id,
                                 data.name
                               )
                             " class="typeahead--list">
                                            <b>{{ data.name }}</b>
                                        </li>
                                    </ul>
                                </div>
                                <mat-error *ngIf="submitted && f.client.errors">
                                    <div *ngIf="f.client.errors.required">Por favor, seleccione un Cliente</div>
                                </mat-error>
                            </mat-form-field>

                            <div>
                                <button [disabled]="disabledButoon" matTooltip="Buscar" class="button-search" (click)="searchClient()">
                                        <i class="fas fa-search"></i>
                                    </button>
                            </div>
                        </div>
                        <input formControlName="client_id" matInput="" style="display: none;" />
                        <div class="form-group" class="width-form-groud col-12 col-xs-6 col-sm-6 col-md-6 col-lg-6">
                            <mat-form-field class="example-full-width ">
                                <mat-label>Sucursal(*)</mat-label>

                                <input type="text" placeholder="Sucursal(*)" aria-label="Number" matInput formControlName="sucursal">
                                <div class="typeahead--wrapper" *ngIf="openOptionClient2">
                                    <ul class="typeahead--ul">
                                        <li *ngFor="let data2 of filteredOptions2" (click)="
                               setDataFormul2($event,
                                 data2.id,
                                 data2.name
                               )
                             " class="typeahead--list">
                                            <b>{{ data2.name }}</b>
                                        </li>
                                    </ul>
                                </div>
                                <mat-error *ngIf="submitted && f.sucursal.errors">
                                    <div *ngIf="f.sucursal.errors.required  ">Por favor, seleccione una Sucursal</div>
                                </mat-error>
                            </mat-form-field>

                            <div>
                                <button [disabled]="disabledButoon" matTooltip="Buscar" class="button-search" (click)="searchClient2()">
                                        <i class="fas fa-search"></i>
                                    </button>
                            </div>
                        </div>
                        <input formControlName="sucursal_id" matInput="" style="display: none;" />

                        <!--
                        <mat-form-field class="col-12 col-xs-4 col-sm-4 col-md-6 col-lg-6">
                            <mat-label>Sucursal (*)</mat-label>
                            <input matInput formControlName="sucursal" id="sucursal" type="text" />
                        </mat-form-field>-->

                    </div>

                </div>
                <br><br>
                <div class="user-margin-buttons">
                    <div class="row">

                        <div class="col-4 col-xs-4 col-sm-4 col-md-4 col-lg-4">
                            <button tabindex="-1" mat-raised-button color="accent" matStepperNext>
                                <img src="../../../../../assets/menuIcons/next_w.png" height="36px" alt="">
                              </button> </div>
                    </div>
                </div>



            </form>
        </mat-step>
        <mat-step [stepControl]="myControl2 " [optional]="isOptional">
            <form [formGroup]="myControl2" class="user-form-top">
                <ng-template matStepLabel>Entrada</ng-template>
                <div class="form-group"><br>
                    <mat-toolbar>
                        Nueva Entrada
                    </mat-toolbar><br>
                    <div class="row">
                        <mat-form-field class="col-12 col-xs-4 col-sm-4 col-md-6 col-lg-6">
                            <mat-label>Servicio (*)</mat-label>

                            <input aria-label="Number" type="text" placeholder="Servicio" matInput formControlName="myControl_ser" [matAutocomplete]="auto">
                            <mat-autocomplete (optionSelected)="onSelectionChanged4($event)" autoActiveFirstOption #auto="matAutocomplete">
                                <!--[displayWith]="displayFn"-->

                                <mat-option *ngFor="let option  of filteredOptions4  | async" [value]="option">
                                    {{ option.name }}
                                </mat-option>
                            </mat-autocomplete>
                        </mat-form-field>
                        <mat-form-field class="col-12 col-xs-4 col-sm-4 col-md-6 col-lg-6">
                            <mat-label>Peso (*)</mat-label>

                            <input matInput formControlName="peso" id="peso" type="number" min="0" />
                        </mat-form-field>
                        <mat-form-field class="col-12 col-xs-4 col-sm-4 col-md-6 col-lg-6">
                            <mat-label>Cantidad (*)</mat-label>

                            <input matInput formControlName="cantidad" id="cantidad" type="number" min="0" />
                        </mat-form-field>


                        <mat-form-field class="col-12 col-xs-4 col-sm-4 col-md-6 col-lg-6">
                            <mat-label>color (*)</mat-label>
                            <mat-select formControlName="color" id="color">
                                <mat-option *ngFor="let col  of colores" [value]="col.id">
                                    {{col.color}}
                                </mat-option>
                            </mat-select>
                            <mat-error *ngIf="submitted && f.tipo.errors">
                                <div *ngIf="f.tipo.errors.required">
                                    Por favor, ingrese un color
                                </div>
                            </mat-error>
                        </mat-form-field>
                        <mat-form-field class="col-12 col-xs-4 col-sm-4 col-md-6 col-lg-6">
                            <mat-label>subservicio (*)</mat-label>

                            <input aria-label="Number" type="text" placeholder="subservicio" matInput formControlName="myControl_sub" [matAutocomplete]="auto2">
                            <mat-autocomplete (optionSelected)="onSelectionChanged($event)" autoActiveFirstOption #auto2="matAutocomplete">
                                <!--[displayWith]="displayFn"-->

                                <mat-option *ngFor="let option  of filteredOptions3  | async" [value]="option">
                                    {{ option.name }}
                                </mat-option>
                            </mat-autocomplete>
                        </mat-form-field>
                        <mat-form-field class="col-12 col-xs-4 col-sm-4 col-md-6 col-lg-6">
                            <mat-label>tipo (*)</mat-label>
                            <mat-select formControlName="tipo" id="tipo">
                                <mat-option *ngFor="let t  of tipoRopa" [value]="t.value">
                                    {{t.value}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>

                        <div class="col-12 col-xs-4 col-sm-4 col-md-6 col-lg-6">
                            <button mat-raised-button color="primary" class="btn btn-accent " (click)="add()" [disabled]="!myControl2.valid || idsubservicio===0 || idsubservicio4===0">+</button>&nbsp; &nbsp;
                            <button mat-raised-button color="primary" class="btn btn-accent " (click)="clearInput()" color="accent">Limpiar</button>&nbsp; &nbsp;

                            <!--[disabled]="!myControl.valid" (click)="reset()"-->
                        </div>

                    </div>


                    <mat-toolbar>
                        Operaciones realizadas
                    </mat-toolbar>
                    <div class="row">


                        <div id="table" class="table-editable miTableTripulante">
                            <table mdbTable borderless="true" id="tablacrews">
                                <thead>
                                    <tr>
                                        <th class="text-center">#</th>
                                        <th class="text-center">Servicio</th>
                                        <th class="text-center">Peso</th>
                                        <th class="text-center">Cantidad</th>
                                        <th class="text-center">Color</th>
                                        <th class="text-center">Sub Servicio</th>
                                        <th class="text-center">Tipo</th>

                                        <th class="text-center" colspan="2">Opciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr mdb TableCol *ngFor="let person of personList; let id = index">
                                        <td class="text-center">
                                            {{ id + 1 }}
                                        </td>
                                        <td class="text-center">
                                            {{person.servicio }}
                                        </td>
                                        <td class="text-center">
                                            {{person.peso }}

                                        </td>
                                        <td class="text-center">
                                            {{person.cantidad }}

                                        </td>
                                        <td class="text-center">
                                            {{person.color }}

                                        </td>
                                        <td class="text-center">
                                            {{person.subservicio }}
                                        </td>
                                        <td class="text-center">
                                            {{person.tipo }}
                                        </td>
                                        <td class="text-center">
                                            <span class="table-remove" *ngIf="!loading">
                                                <a (click)="edittri(id)">
                                                    <mdb-icon
                                                    fas
                                                    icon="edit"
                                                    size="4.5x"
                                                     matTooltip="Editar"
                                                    > </mdb-icon>  
                                                </a>
                                                </span>

                                        </td>
                                        <td class="text-center">

                                            <span class="table-remove" *ngIf="!loading">
                                                            <a (click)="remove(id)">
                                                                <mdb-icon
                                                                fas
                                                                icon="trash-alt"
                                                                size="4.5x"
                                                                style="color:#CD6155"
                                                                matTooltip="Eliminar"
                                                                > </mdb-icon>  
                                                            </a>
                                                            </span>
                                        </td>
                                    </tr>

                                </tbody>
                            </table>

                        </div>
                    </div>

                    <div class="container">
                        <div class="row">
                            <div class="col-4 col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                <button tabindex="-1" mat-raised-button color="accent" matStepperPrevious>
                                    <img src="../../../../../assets/menuIcons/back_w.png" height="36px" alt="">
                                  </button> </div>

                            <div class="col-4 col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                <button tabindex="-1" mat-raised-button (click)="onSubmit()" color="primary">
                                    <strong>Guardar</strong> 
                                    </button>
                            </div>

                            <div class="col-4 col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                <button tabindex="-1" [disabled]="loading" type="button" (click)="closeModal()" mat-raised-button color="accent" style="color:white" class="btn btn-accent">
                                        
                                    <strong>Cancelar</strong>
                                  </button>
                            </div>
                        </div>
                    </div><br><br>


                </div>
            </form>
        </mat-step>
    </mat-horizontal-stepper>


</div>